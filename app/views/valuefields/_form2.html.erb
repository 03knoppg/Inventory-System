<%= form_for(@valuefield) do |f| %>
    <% if @valuefield.errors.any? %>

        <div id="error_explanation">
          <h2><%= pluralize(@valuefield.errors.count, "error") %> prohibited this valuefield from being saved:</h2>

          <ul>
            <% @valuefield.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>
    <table>
      <tr>
        <th align="left" colspan="3">Product Path</th>
      </tr>
      <tr>
        <td colspan="3">
          <div class ="field">
            <select name="path">
              <option selected="true"  value="-1">No Selection</option>
              <%=get_paths_as_select.html_safe%>
            </select>
          </div>
        </td>
      </tr>
      <tr>
        <td align="left" colspan="3"><h2>OR</h2></td>
      </tr>
      <tr>
        <th align="left" colspan="3">Product or Component</th>
      </tr>
      <tr>
        <td>
          <div class ="field">
            <select name="prod_comp_id">
              <option selected="true" value="-1">No Selection</option>
              <!--Product id is negative to differentiate from component-->
              <% parent_comp = @valuefield.component
                 parent_prod = @valuefield.product

                 for pc in @all_prods_comps %>
                  <option value= <%if(pc.is_a?(Product))%>"<%="#{(-pc.id)-1}"%>"
            <%else%>
                 "<%=pc.id%>"
            <%end%>
            <% if((parent_comp != nil && parent_comp.id == pc.id) ||
                    (parent_prod != nil && parent_prod.id == pc.id)) %>
              selected = true
            <% end %>>
            <%= pc.name%> </option>
              <% end %>
            </select>
          </div>
        </td>
      </tr>
      <tr>
        <td align="left"><h2>AND</h2></td>
      </tr>
      <tr>
        <th align="left">Property</th>
        <th align="left">Value</th>
        <th align="left">Actions</th>
      </tr>
      <tr>
        <td>
          <div class ="field">

             <%= text_field_tag 'property',  @valuefield.property.name, :disabled => true %>

          </div>
        </td>
        <td>
          <div class="field">
            <%= f.text_field :fieldvalue %>
          </div>
        </td>
        <td>
          <div class="actions">
            <%= f.submit %>
          </div>
        </td>
      </tr>
    </table>
<%end%>
<br class="clear" />
