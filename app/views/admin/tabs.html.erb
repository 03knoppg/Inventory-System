<a class="tab_title tab_title_expanded" href="#"><h1 class="title_header"><%=image_tag "Accordian/bigminus.gif"%>&nbspProduct: <%= @product.name %></h1></a>

<!--Page Container -->
<div class="inner_container">
<div id="products_partial"><%= render "products/popup_show" %></div>
<!-- Tabs for directly related objects to the Product -->
<div class="tabs">
<ul>
  <li><a class="l" href="">Components</a></li>
  <li><a class="l" href="">Properties</a></li>
  <li><a class="l" href="">Value Fields</a></li>
  <li><a class="l" href="">Images</a></li>
  <li><a class="l" href="">Data Files</a></li>
</ul>
<div>
<div>
  <%= render :partial=>"admin/components_tabs", :locals => {:parent => @product}%>
</div>
<div>
  <!-- Tabs for directly related Properties to the Product -->
  <div class="tabs">
    <% if (!@product_properties.empty?) %>
        <ul>
          <% for properties in @product_properties %>
              <li><a href=""><%= properties.name %></a></li>
          <% end %>
        </ul>
        <div>
          <% for property in @product_properties %>
              <% @property = property %>
              <div><%= render("/properties/show", :object => [@property]) %></div>
          <% end %>
        </div>
    <% else %>
        <h5>None Available.</h5>
    <% end %>
  </div>
</div>
<div>
  <!-- Tabs for directly related ValueFields to the Product -->
  <div class="tabs">
    <% if (!@product_valuefields.empty?) %>
        <ul>
          <% for valuefield in @product_valuefields %>
              <li><a href=""><%= valuefield.name %></a></li>
          <% end %>
        </ul>
        <div>
          <% for valuefield in @product_valuefields %>
              <% @valuefield = valuefield %>
              <div><%= render("/valuefields/show", :object => [@valuefield]) %></div>
          <% end %>
        </div>
    <% else %>
        <h5>None Available.</h5>
    <% end %>
  </div>
</div>
<div>
  <!-- Tabs for directly related Images to the Product -->
  <div class="tabs">
    <% if (!@product_images.empty?) %>
        <ul>
          <% for image in @product_images %>
              <li><a href=""><%= image.picture_file_name %></a></li>
          <% end %>
        </ul>
        <div>
          <% for image in @product_images %>
              <% @image = image %>
              <div><%= render("/images/show", :object => [@image]) %></div>
          <% end %>
        </div>
    <% else %>
        <h5>None Available.</h5>
    <% end %>
  </div>
</div>
<div>
  <!-- Tabs for directly related Data Files to the Product -->
  <div class="tabs">
    <% if (!@product_datafiles.empty?) %>
        <ul>
          <% for datafile in @product_datafiles %>
              <li><a href="" class="xl"><%= datafile.filedata_file_name %></a></li>
          <% end %>
        </ul>
        <div>
          <% for datafile in @product_datafiles %>
              <% @data_file = datafile %>
              <div><%= render("/data_files/show", :object => [@data_file]) %></div>
          <% end %>
        </div>
    <% else %>
        <h5>None Available.</h5>
    <% end %>
  </div>
</div>
</div>
</div>
</div>
<script type="text/javascript">
    jQuery(function($) {

        $('a.tab_title').live('click',expandColapseSection);



        $('.inner_container:first').css("overflow-x" ,"hidden");
        $('.inner_container:first').css("overflow-y", "scroll");


        $('div.tabs2 > ul > li > a').live('click',function () {

            if($(this).attr("href") != ""){
                $('#'+$(this).attr("href")).html("");
                $.get("/admin/load_component_tab", {item: $(this).attr("href")}, null, 'script');

            }

            return false;
        });


        moveULs();
        setUpSliders();
        adjustWidth($('div.tabs2  div.inner_container'), true, false);



    });

    function expandColapseSection(){
        inner_container = $(this).siblings('.inner_container');

        //minimize
        if($(this).hasClass("tab_title_expanded")){
            $(this).removeClass("tab_title_expanded");
            $(this).addClass("tab_title_minimized");
            $(this).find('img').attr("src", "/assets/Accordian/plus.gif");
            $(this).find('h1').css({fontSize: "150%"});

            inner_container.css("overflow-x" ,"hidden");
            inner_container.css("overflow-y" ,"hidden");
            inner_container.find('div.inner_container:first').parent().parent().children('*').children('div.inner_container').each(function(){
                $(this).css("overflow-x" ,"hidden");
                $(this).css("overflow-y" ,"scroll");
            });


            inner_container.children('div:first').animate({height: 'toggle'});
            inner_container.find('div.tabs:first > div').css("border", 0);
            inner_container.find('div.tabs:first > ul').animate({height: 'toggle'});
            inner_container.find('div.tabs:first > ul > li').animate({height: 'toggle'});

            //inner_container.find('div.tabs2:first > ul').animate({width: '0'});
            inner_container.find('div.tabs2:first > ul').css({width: '0'});

            //inner_container.find('div.tabs2:first > div').animate({width: '100%'});
            inner_container.find('div.tabs2:first > div').css({width: '100%'});

            inner_container.find('div.tabs2:first > div').css("border-top", 0);
            adjustHeight();
            inner_container.find('.inner_container').each(function(){
                if($(this).width() > 0)
                    adjustWidth($(this), false, true);
            });
        }

        //expand
        else{

            $(this).removeClass("tab_title_minimized");
            $(this).addClass("tab_title_expanded");
            $(this).find('img').attr("src", "/assets/Accordian/bigminus.gif");
            $(this).find('h1').css({fontSize: "300%"});

            inner_container.css("overflow-x" ,"hidden");
            inner_container.css("overflow-y" ,"scroll");
            inner_container.find('div.inner_container:first').parent().parent().children('*').children('div.inner_container').each(function(){
                $(this).css("overflow-x" ,"hidden");
                $(this).css("overflow-y" ,"hidden");
            });

            inner_container.children('div:first').animate({height: 'toggle'});
            inner_container.find('div.tabs:first > div').css("border", "1px solid #999");
            inner_container.find('div.tabs:first > div').css("border-top", 0);
            inner_container.find('div.tabs:first > ul').animate({height: 'toggle'});
            inner_container.find('div.tabs:first > ul > li').animate({height: 'toggle'});

            //inner_container.find('div.tabs2:first > ul').animate({width: 'toggle'});
            inner_container.find('div.tabs2:first > ul').css("width", '132');

            fullwidth = inner_container.find('div.tabs2:first').width();
            ulWidth = inner_container.find('div.tabs2:first > ul').width();
            inner_container.find('div.tabs2:first > div').css({width:fullwidth - 132});

            inner_container.find('div.tabs2:first > div').css("border-top", "1px solid #999");
            adjustHeight();
            $('.inner_container').each(function(){
                if($(this).width() > 0)
                    adjustWidth($(this), false, false);
            });
        }


    }

    function setUpSliders(){
        //Expand/Collapse javascript
        $(".content").hide();
        $(".heading").unbind('click');
        //toggle the componenet with class msg_body
        $(".heading").bind("click", function() {
            $(this).next(".content").slideToggle(1200).scroll();
        });
    }

    function cleanUp(id){
        pane = $("#"+id);

        pane.find('div.tabs, div.tabs2').each(function(){
           $(this).find('ul:first').tabs($(this).find('div:first > div'));
        });

        pane.find(".content").hide();                             //toggle the componenet with class msg_body
        pane.find(".heading").click(function() {
            $(this).next(".content").slideToggle(1200).scroll();
        });



        $("html").addClass("js");
        $.fn.accordion.defaults.container = false;

        pane.find(".accordion").accordion();

        $("html").removeClass("js");


        //adjustWidth(pane.find('div.tabs2').find('.inner_container:first'), false, false);
        adjustWidth(pane.find('div.tabs2').find('.inner_container:first'), false, false);
        adjustHeight();

    }

    function adjustHeight(){
       $('.inner_container').each(function(){
           if($(this).css("overflow-y") == "scroll"){
               $(this).css("height", "630");
           }
            else {
               $(this).css("height","100%");
           }
        });
        $('.container').css({height:862});
    }

    function adjustWidth(pane, first, minimizing) {

        tabs = pane.closest('div.tabs2');
        if(tabs == null)
            return;

        tabwidth = Number(tabs.width());
        ulWidth = Number(tabs.children('ul').width());
        if(ulWidth == null)
            ulWidth = 0;

        //ulWidth = 0;
        if(first /* || tabs.find('div.inner_container').css("overflow-y") == "scroll"*/)
            tabs.find(' > div').width(tabwidth - ulWidth - 15);
        else if(minimizing){
            tabs.find(' > div').width(tabwidth - 134);
            tabs.find(' > div').animate({width: tabwidth});
        }
        else
            tabs.find(' > div').width(tabwidth - ulWidth);
        /*if($(this).closest('div.inner_container').siblings('a.tab_title_expanded'))
            $(this).find(' > div').width(width - ulWidth - 15);
        else
            $(this).find(' > div').width(width - ulWidth);*/

    }



    function moveULs(){

        $('.inner_container').scroll(function(){
            container = $(this);
            offset = container.offset().top + 3;
            container.find('div.tabs2 > ul').each(function(){
                if( $(this).parent().position().top < offset){
                   $(this).css("top", offset);
                   $(this).css("position", "fixed");

                } else {
                   $(this).css("top", 0);
                   $(this).css("position", "");
                }
            });

        });

    }
</script>


